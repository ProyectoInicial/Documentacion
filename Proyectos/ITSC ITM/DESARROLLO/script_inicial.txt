/**
Creacion de la BD con el usuario maestro, ROOT
**/

CREATE DATABASE ITSC_DATA;
USE ITSC_DATA;
CREATE USER 'ITSC_DATA'@'localhost' IDENTIFIED BY 'itsc_data';
GRANT ALL PRIVILEGES ON ITSC_DATA.* TO 'ITSC_DATA'@'localhost' WITH GRANT OPTION;
FLUSH PRIVILEGES;

/**
Se crea el usuario para la aplicacion web.
**/
CREATE USER 'ITSC_OPER'@'localhost' IDENTIFIED BY 'itsc_oper';
GRANT DELETE,INSERT,SELECT,UPDATE ON ITSC_DATA.* TO 'ITSC_OPER'@'localhost' ;
FLUSH PRIVILEGES;

CREATE TABLE ITSC_DATA.CAT_PERMISOS (
PERMISO_ID BIGINT(19) NOT NULL AUTO_INCREMENT , 
PERMISO_NOMBRE VARCHAR(100)   NOT NULL , 
PERMISO_DESCRIPCION VARCHAR(100)   NOT NULL , 
PERMISO_FORM INT(1)   NOT NULL , 
PERMISO_STATUS_FLAG INT(2)    NOT NULL , 
PERMISO_LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (PERMISO_ID)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_PANTALLAS (
PANTALLA_ID BIGINT(19) NOT NULL AUTO_INCREMENT , 
PANTALLA_NOMBRE VARCHAR(100)   NOT NULL , 
PANTALLA_DESCRIPCION VARCHAR(100)   NOT NULL , 
PANTALLA_STATUS_FLAG INT(2)    NOT NULL , 
PANTALLA_LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (PANTALLA_ID)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_PANT_DETALLE (
PANT_DET_ID BIGINT(19) NOT NULL AUTO_INCREMENT ,
PANTALLA_ID BIGINT(19) NOT NULL,
PANT_DET_NOMBRE VARCHAR(100)   NOT NULL , 
PANT_DET_URL VARCHAR(100)   NOT NULL , 
PANT_DET_STATUS_FLAG INT(2)    NOT NULL , 
PANT_DET_LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (PANT_DET_ID)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;
alter table ITSC_DATA.CAT_PANT_DETALLE add foreign key(PANTALLA_ID) references ITSC_DATA.CAT_PANTALLAS (PANTALLA_ID);

CREATE TABLE ITSC_DATA.CAT_ROLES (
ROL_ID BIGINT(19) NOT NULL AUTO_INCREMENT , 
ROL_DESCRIPCION VARCHAR(100)   NOT NULL , 
ROL_STATUS_FLAG INT(2)    NOT NULL , 
ROL_LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ROL_ID)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_PERM_ROL (
PERM_ROL_ID BIGINT(19) NOT NULL AUTO_INCREMENT ,
ROL_ID BIGINT(19) NOT NULL,
PERMISO_ID BIGINT(19) NOT NULL,
PERM_ROL_NOMBRE VARCHAR(100)   NOT NULL , 
PERM_ROL_STATUS_FLAG INT(2)    NOT NULL , 
PERM_ROL_LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (PERM_ROL_ID)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;
alter table ITSC_DATA.CAT_PERM_ROL add foreign key(ROL_ID) references ITSC_DATA.CAT_ROLES (ROL_ID);
alter table ITSC_DATA.CAT_PERM_ROL add foreign key(PERMISO_ID) references ITSC_DATA.CAT_PERMISOS (PERMISO_ID);

CREATE TABLE ITSC_DATA.CAT_ACTORES (
ACTOR_ID BIGINT(19) NOT NULL AUTO_INCREMENT , 
ACTOR_DESCRIPCION VARCHAR(100)   NOT NULL , 
ACTOR_STATUS_FLAG INT(2)    NOT NULL , 
ACTOR_VIG_INIC TIMESTAMP NOT NULL,
ACTOR_VIG_FIN TIMESTAMP NOT NULL,
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ACTOR_ID)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_ACTORES_ROLES (
ACTOR_ROL_ID BIGINT(19) NOT NULL AUTO_INCREMENT , 
ACTOR_ID BIGINT(19) NOT NULL  , 
ROL_ID BIGINT(19) NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ACTOR_ROL_ID)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;
alter table ITSC_DATA.CAT_ACTORES_ROLES add foreign key(ACTOR_ID) references ITSC_DATA.CAT_ACTORES (ACTOR_ID);
alter table ITSC_DATA.CAT_ACTORES_ROLES add foreign key(ROL_ID) references ITSC_DATA.CAT_ROLES (ROL_ID);

CREATE TABLE ITSC_DATA.CAT_TIPO_CAMION (
ID_TIPO_CAMION BIGINT(19) NOT NULL AUTO_INCREMENT , 
DESC_TIPO_CAMION VARCHAR(100)   NOT NULL , 
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_TIPO_CAMION)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_LOTE_CAMION (
ID_LOTE_CAMION BIGINT(19) NOT NULL AUTO_INCREMENT , 
DESC_RS_CAMION VARCHAR(100)   NOT NULL , 
ID_TIPO_CAMION BIGINT(19) NOT NULL ,
PLACAS_CAMION VARCHAR(10)   NOT NULL , 
CAP_CAMION INT(15)    NOT NULL,
CAP_UM_CAMION VARCHAR(10)   NOT NULL , 
PERM_SICULA_CAMION VARCHAR(1)   NOT NULL , 
FECH_EXP_PERM_SICULA_CAMION TIMESTAMP NOT NULL,
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_LOTE_CAMION)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;
alter table ITSC_DATA.CAT_LOTE_CAMION add foreign key(ID_TIPO_CAMION) references ITSC_DATA.CAT_TIPO_CAMION (ID_TIPO_CAMION);

CREATE TABLE ITSC_DATA.CAT_CHOFERES (
ID_CHOFER BIGINT(19) NOT NULL AUTO_INCREMENT , 
NOMBRE_CHOFER VARCHAR(100)   NOT NULL , 
APELLIDOS_CHOFER VARCHAR(100)   NOT NULL , 
LICENCIA_NUM_CHOFER VARCHAR(100)   NOT NULL , 
FECHA_VENCI_LICEN TIMESTAMP NOT NULL,
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_CHOFER)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_TARIFAS (
ID_TARIFA BIGINT(19) NOT NULL AUTO_INCREMENT , 
ID_TIPO_TARIFA BIGINT(19) NOT NULL,
DESC_TIPO_TARIFA VARCHAR(100)   NOT NULL , 
ID_CONTRATO VARCHAR(100)   NOT NULL , 
CRIT_DESDE_TARIFA VARCHAR(100)   NOT NULL , 
CRIT_HASTA_TARIFA VARCHAR(100)   NOT NULL , 
FECHA_VIG_DESDE TIMESTAMP NOT NULL,
FECHA_VIG_HASTA TIMESTAMP NOT NULL,
PRECIO_TARIFA DECIMAL(15,4),
MIN_ASEG_TARIFA DECIMAL(15,4),
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_TARIFA)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;
alter table ITSC_DATA.CAT_TARIFAS add foreign key(ID_TIPO_TARIFA) references ITSC_DATA.CAT_TIPO_TARIFA (ID_TIPO_TARIFA);

CREATE TABLE ITSC_DATA.CAT_TIPO_TARIFA (
ID_TIPO_TARIFA BIGINT(19) NOT NULL AUTO_INCREMENT , 
DESC_TIPO_TARIFA VARCHAR(100)   NOT NULL , 
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_TIPO_TARIFA)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_CONCEPT_TARIFA (
ID_CONCEPT_TARIFA BIGINT(19) NOT NULL AUTO_INCREMENT , 
DESC_CONCEPT_TARIFA VARCHAR(100)   NOT NULL , 
COD_MANIOBRA_TARIFA BIGINT(19) NOT NULL,
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_CONCEPT_TARIFA)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_TIPO_CARG_DESC (
ID_TIPO_CARG_DESC BIGINT(19) NOT NULL AUTO_INCREMENT , 
DESC_TIPO_CARG_DESC VARCHAR(100)   NOT NULL , 
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_TIPO_CARG_DESC)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_TIPO_VIAJE(
ID_TIPO_VIAJE BIGINT(19) NOT NULL AUTO_INCREMENT , 
DESC_TIPO_VIAJE VARCHAR(100)   NOT NULL , 
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_TIPO_VIAJE)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_TIPO_INCIDENCIA(
ID_TIPO_INCIDENCIA BIGINT(19) NOT NULL AUTO_INCREMENT , 
DESC_TIPO_INCIDENCIA VARCHAR(100)   NOT NULL , 
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_TIPO_INCIDENCIA)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_RESP_INCIDENCIA(
ID_RESP_INCIDENCIA BIGINT(19) NOT NULL AUTO_INCREMENT , 
DESC_RESP_INCIDENCIA VARCHAR(100)   NOT NULL , 
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_RESP_INCIDENCIA)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_ESTADO_VIAJE(
ID_ESTADO_VIAJE BIGINT(19) NOT NULL AUTO_INCREMENT , 
DESC_RESTADO_VIAJE VARCHAR(100)   NOT NULL , 
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_ESTADO_VIAJE)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_TIPO_CLIENTE(
ID_TIPO_CLIENTE BIGINT(19) NOT NULL AUTO_INCREMENT , 
DESC_TIPO_CLIENTE VARCHAR(100)   NOT NULL , 
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_TIPO_CLIENTE)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;

CREATE TABLE ITSC_DATA.CAT_CLIENTES(
ID_CLIENTE BIGINT(19) NOT NULL AUTO_INCREMENT , 
DESC_RS_CLIENTE VARCHAR(100)   NOT NULL , 
CALLE_CLIENTE VARCHAR(100)   NOT NULL , 
NUMERO_CLIENTE VARCHAR(100)   NOT NULL , 
INTERIOR_CLIENTE VARCHAR(100)   NOT NULL , 
COLONIA_CLIENTE VARCHAR(100)   NOT NULL , 
DELEGACION_CLIENTE VARCHAR(100)   NOT NULL , 
ESTADO_CLIENTE VARCHAR(100)   NOT NULL , 
CP_CLIENTE VARCHAR(100)   NOT NULL , 
PAIS_CLIENTE VARCHAR(100)   NOT NULL , 
ID_TIPO_CLIENTE BIGINT(19) NOT NULL,
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_CLIENTE)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;
alter table ITSC_DATA.CAT_CLIENTES add foreign key(ID_TIPO_CLIENTE) references ITSC_DATA.CAT_TIPO_CLIENTE (ID_TIPO_CLIENTE);

CREATE TABLE ITSC_DATA.CAT_CLIENTE_CONTRATO(
ID_CLIENTE_CONTRATO BIGINT(19) NOT NULL AUTO_INCREMENT , 
ID_CLIENTE BIGINT(19) NOT NULL , 
VIG_DESDE_CONTRATO TIMESTAMP NOT NULL,
VIG_HASTA_CONTRATO TIMESTAMP NOT NULL,
DOC_CONTRATO VARCHAR(100)   NOT NULL ,
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_CLIENTE_CONTRATO)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;
alter table ITSC_DATA.CAT_CLIENTE_CONTRATO add foreign key(ID_CLIENTE) references ITSC_DATA.CAT_CLIENTES (ID_CLIENTE);

CREATE TABLE ITSC_DATA.TRAN_VIAJES_HEADER(
VIJES_H_FOLIO_ID BIGINT(19) NOT NULL AUTO_INCREMENT , 
VIAJES_H_ESTADO
VIAJES_H_SOLICITANTE
VIAJES_H_AUTORIZADOR
VIAJES_H_AUTORIZADOR_GERENTE
VIAJES_H_FECHA_SOLICITUD
VIAJES_H_HORA_SOLICITUD
VIAJES_H_FECHA_AUTORIZACION_JEFE
VIAJES_H_HORA_AUTORIZACION_JEFE
VIAJES_H_FECHA_AUTORIZACION_GERENTE
VIAJES_H_ORA_AUTORIZACION_GERENTE
VIAJES_H_TOTAL_A_FACTURAR	
VIAJES_H_FECHA_RETORNO_PDO	
VIAJES_H_HORA_RETORNO_PDO	
VIAJES_H_FECHA_ENTREGA_FILE
VIAJES_H_HORA_ENTREGA_FILE	
VIAJES_H_FECHA_FACTURACION	
VIAJES_H_HORA_FACTURACION
VIAJES_H_NUMERO_DE_FACTURA
STATUS_FLAG INT(2)    NOT NULL , 
LAST_UPDATE_DT TIMESTAMP NOT NULL default '0000-00-00 00:00:00', 
LAST_UPDATE_USER VARCHAR(50)   ,
PRIMARY KEY (ID_CLIENTE_CONTRATO)
) ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=latin1;


/*
DROP DATABASE ITSC_DATA;
DROP USER 'ITSC_DATA'@'localhost';
set foreign_key_checks=0;
DROP TABLE  ITSC_DATA.CAT_ROLES;
DROP TABLE  ITSC_DATA.CAT_ACTORES ;
DROP TABLE  ITSC_DATA.CAT_ACTORES_ROLES ;
DROP TABLE  ITSC_DATA.CAT_TIPO_CAMION ;
DROP TABLE  ITSC_DATA.CAT_LOTE_CAMION ;
DROP TABLE  ITSC_DATA.CAT_CHOFERES; 

DROP TABLE  ITSC_DATA.CAT_TARIFAS ;
DROP TABLE  ITSC_DATA.CAT_TIPO_TARIFA ;
DROP TABLE  ITSC_DATA.CAT_CONCEPT_TARIFA ;
DROP TABLE  ITSC_DATA.CAT_TIPO_CARG_DESC ;

DROP TABLE  ITSC_DATA.CAT_TIPO_VIAJE ;
DROP TABLE  ITSC_DATA.CAT_TIPO_INCIDENCIA;
DROP TABLE  ITSC_DATA.CAT_RESP_INCIDENCIA ;
DROP TABLE  ITSC_DATA.CAT_ESTADO_VIAJE ;
DROP TABLE  ITSC_DATA.CAT_ESTADO_VIAJE ;

DROP TABLE  ITSC_DATA.CAT_TIPO_CLIENTE ;
DROP TABLE  ITSC_DATA.CAT_CLIENTES ;
DROP TABLE  ITSC_DATA.CAT_CLIENTE_CONTRATO;

DROP TABLE  ITSC_DATA.TRAN_VIAJES_HEADER;
DROP TABLE  ITSC_DATA.TRAN_VIAJES_CAMION;

set foreign_key_checks=1;
*/